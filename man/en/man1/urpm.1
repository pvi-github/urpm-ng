.\" Man page for urpm
.TH URPM 1 "January 2025" "urpm-ng" "User Commands"
.SH NAME
urpm \- modern package manager for Mageia Linux
.SH SYNOPSIS
.B urpm
.RI [ options ]
.I command
.RI [ arguments ]
.SH DESCRIPTION
.B urpm
is a modern package manager for Mageia Linux, providing fast dependency
resolution using libsolv, P2P package sharing between LAN machines,
and an intuitive command-line interface.
.PP
It is designed as a complete rewrite of the classic urpmi toolset.
.SH OPTIONS
.TP
.BR \-h ", " \-\-help
Show help message and exit.
.TP
.BR \-V ", " \-\-version
Show version number and exit.
.TP
.BR \-v ", " \-\-verbose
Verbose output.
.TP
.BR \-q ", " \-\-quiet
Quiet output.
.TP
.B \-\-nocolor
Disable colored output.
.SH COMMANDS
.SS Package Installation and Removal
.TP
.B i|install \fIpackage\fR ...
Install one or more packages.
.RS
.TP
.BR \-y ", " \-\-auto
No confirmation prompt.
.TP
.B \-\-download\-only
Download packages without installing.
.TP
.B \-\-without\-recommends
Do not install recommended packages.
.TP
.B \-\-with\-suggests
Also install suggested packages.
.TP
.B \-\-only\-peers
Only download from LAN peers, no upstream mirrors.
.TP
.BR \-b ", " \-\-builddeps " " \fI[spec]\fR
Install build dependencies from spec file or SRPM. Auto-detects if no file specified.
.TP
.B \-\-sync
Wait for all scriptlets and triggers to complete before returning.
.RE
.TP
.B e|erase \fIpackage\fR ...
Remove one or more packages. Aliases: \fBremove\fR.
.RS
.TP
.BR \-y ", " \-\-auto
No confirmation prompt.
.TP
.B \-\-auto\-orphans
Also remove orphaned dependencies.
.RE
.TP
.B autoremove
Remove orphaned packages, old kernels, or failed dependencies.
.SS Package Updates
.TP
.B up|update \fR[\fIpackage\fR ...]
Update various things media, packages...
.RS
.B This will be reworked on : prefer upgrade for packages instead.\fR
.RE
.TP
.B u|upgrade \fR[\fIpackage\fR ...]
Upgrade packages (system upgrade if none specified).
.RS
.TP
.B \-\-only\-peers
Only download from LAN peers, no upstream mirrors.
.RE
.SS Package Information
.TP
.B q|query \fIpattern\fR
Search for packages by name or description. Aliases: \fBs\fR, \fBsearch\fR.
.TP
.B show \fIpackage\fR
Show detailed package information.
.TP
.B list \fR[\fIpattern\fR]
List packages. Use \fB\-\-installed\fR for installed packages only.
.TP
.B provides \fIpackage\fR
Show what capabilities a package provides.
.TP
.B whatprovides \fIcapability\fR
Find packages providing a capability.
.TP
.B find \fIfile\fR
Find which package contains a file.
.RS
.B (Not implemented yet)
.RE
.TP
.B depends \fIpackage\fR
Show package dependencies.
.TP
.B rdepends \fIpackage\fR
Show reverse dependencies.
.TP
.B why \fIpackage\fR
Explain why a package is installed.
.SS Media and Server Management
.TP
.B media \fR[\fIsubcommand\fR]
Manage media sources. Without subcommand, lists media.
.RS
.TP
.B list
List configured media.
.TP
.B add \fIname\fR \fIurl\fR
Add a new media.
.TP
.B remove \fIname\fR
Remove a media.
.TP
.B enable \fIname\fR
Enable a media.
.TP
.B disable \fIname\fR
Disable a media.
.TP
.B update \fR[\fIname\fR]
Update media metadata (parallel).
.TP
.B import
Import media configuration from urpmi.
.TP
.B link \fIname\fR \fI+server\fR|\fI-server\fR ...
Link or unlink servers to a media. Use +server to add, -server to remove.
Use +all/-all to add/remove all servers. Only links servers that have the media available.
.TP
.B set \fIname\fR \fR[\fIoptions\fR]
Modify media settings.
.RS
.TP
.B \-\-shared \fIyes\fR|\fIno\fR
Enable/disable sharing this media with peers.
.TP
.B \-\-replication \fIpolicy\fR
Replication policy: none, on_demand, seed.
.TP
.B \-\-seeds \fIsections\fR
rpmsrate sections for seed replication (comma-separated), e.g., INSTALL,CAT_PLASMA5,CAT_GNOME.
.TP
.B \-\-quota \fIsize\fR
Per-media quota (e.g., 5G, 500M).
.TP
.B \-\-retention \fIdays\fR
Days to keep cached packages.
.TP
.B \-\-priority \fIN\fR
Media priority (higher = preferred).
.RE
.TP
.B autoconfig \fB\-\-release\fR \fIversion\fR
Auto-add official Mageia media for a release. Aliases: \fBauto\fR, \fBac\fR.
.RS
.TP
.BR \-r ", " \-\-release " " \fIversion\fR
Mageia release (e.g., 10, cauldron). Required.
.TP
.B \-\-arch \fIarch\fR
Target architecture (default: host).
.TP
.BR \-n ", " \-\-dry\-run
Show what would be added without making changes.
.TP
.B \-\-no\-nonfree
Skip nonfree media.
.TP
.B \-\-no\-tainted
Skip tainted media.
.RE
.RE
.TP
.B server \fR[\fIsubcommand\fR]
Manage download servers. Without subcommand, lists servers.
.RS
.TP
.B list
.RS
List configured servers.
.sp
.BR \-\-all
Lists all servers showing also those disabled
.RE
.TP
.B add \fIname\fR \fIurl\fR
Add a new server.
.TP
.B remove \fIname\fR
Remove a server.
.TP
.B enable \fIname\fR
Enable a server.
.TP
.B disable \fIname\fR
Disable a server.
.TP
.B priority \fIname\fR \fIN\fR
Set server priority (lower = preferred).
.TP
.B autoconfig
Auto-configure servers by testing mirrors.
.RE
.SS P2P and Cache
.TP
.B peer \fR[\fIsubcommand\fR]
Manage P2P peers. Without subcommand, lists peers.
.RS
.TP
.B list
List discovered peers and download statistics.
.TP
.B blacklist \fIhost\fR
Block a peer.
.TP
.B unblacklist \fIhost\fR
Unblock a peer.
.TP
.B clean \fIhost\fR
Delete RPMs downloaded from a peer.
.RE
.TP
.B cache \fIsubcommand\fR
Manage the package cache.
.RS
.TP
.B clean
Remove orphan RPMs from cache.
.TP
.B info
Show cache statistics.
.RE
.SS History and Rollback
.TP
.B history \fR[\fIN\fR]
Show transaction history. Default: last 10 transactions.
.TP
.B rollback \fIspec\fR
Rollback transactions.
.RS
.TP
.B rollback 5
Rollback last 5 transactions.
.TP
.B rollback to 42
Rollback to transaction #42.
.TP
.B rollback to 26/11/2025
Rollback to a specific date.
.RE
.TP
.B undo \fR[\fIN\fR]
Undo last transaction, or transaction #N.
.SS Configuration
.TP
.B config \fIsubcommand\fR
Manage urpm configuration.
.TP
.B key \fIsubcommand\fR
Manage GPG keys for package verification.
.TP
.B mark \fIpackage\fR manual|auto
Mark packages as manually or automatically installed.
.TP
.B hold \fR[\fIpackage\fR ...] [\fB\-r\fR \fIreason\fR]
Hold packages to prevent upgrades and obsoletes replacement.
Without arguments, lists held packages.
.RS
.TP
.BR \-r ", " \-\-reason " " \fIreason\fR
Record a reason for the hold.
.TP
.BR \-l ", " \-\-list
List held packages.
.RE
.TP
.B unhold \fIpackage\fR ...
Remove hold from packages, allowing them to be upgraded or replaced.
.SS Initialization and Download
.TP
.B init \fR[\fB\-\-release\fR \fIversion\fR] [\fB\-\-mirrorlist\fR \fIurl\fR]
Initialize urpm with standard Mageia media. Tests mirrors and configures the best ones.
.RS
.TP
.BR \-r ", " \-\-release " " \fIversion\fR
Mageia version (e.g., 10, cauldron).
.TP
.B \-\-urpm\-root " " \fIpath\fR
Initialize in a chroot directory.
.RE
.TP
.B download \fIpackage\fR ...
Download packages to cache without installing.
.RS
.TP
.BR \-r ", " \-\-release " " \fIversion\fR
Target release for cross-release downloads.
.TP
.BR \-b ", " \-\-builddeps " " \fI[spec]\fR
Download build dependencies from spec file.
.TP
.B \-\-only\-peers
Only download from LAN peers, no upstream mirrors.
.RE
.SS Container Build System
.TP
.B mkimage \fB\-\-release\fR \fIversion\fR \fB\-\-tag\fR \fItag\fR
Create a minimal Docker/Podman image for RPM builds.
.RS
.TP
.BR \-r ", " \-\-release " " \fIversion\fR
Mageia version (e.g., 10, cauldron).
.TP
.BR \-t ", " \-\-tag " " \fItag\fR
Image tag (e.g., mageia:10-build).
.TP
.B \-\-arch " " \fIarch\fR
Target architecture (default: host).
.TP
.BR \-p ", " \-\-packages " " \fIlist\fR
Additional packages (comma-separated).
.TP
.B \-\-runtime " " docker|podman
Container runtime (default: auto-detect).
.TP
.B \-\-keep\-chroot
Keep temporary chroot after image creation.
.TP
.BR \-w ", " \-\-workdir " " \fIpath\fR
Working directory for chroot (default: /tmp).
.RE
.TP
.B build \fB\-\-image\fR \fItag\fR \fIsource\fR ...
Build RPM packages in isolated containers.
.RS
.TP
.BR \-i ", " \-\-image " " \fItag\fR
Docker/Podman image to use.
.TP
.BR \-o ", " \-\-output " " \fIdir\fR
Output directory (default: ./build-output or workspace/{RPMS,SRPMS}).
.TP
.B \-\-runtime " " docker|podman
Container runtime (default: auto-detect).
.TP
.BR \-j ", " \-\-parallel " " \fIN\fR
Number of parallel builds (default: 1).
.TP
.B \-\-keep\-container
Keep container after build (for debugging).
.PP
Sources can be .src.rpm files or .spec files. For .spec files, sources are
automatically copied from the SOURCES/ directory (supports workspace/SPECS/
and workspace/SOURCES/ layouts). Results go to workspace/RPMS/ and
workspace/SRPMS/ for spec builds.
.RE
.SH FILES
.TP
.I /var/lib/urpm/
Database and cache directory.
.TP
.I /var/lib/urpm/packages.db
SQLite database for package metadata and history.
.TP
.I /var/lib/urpm/medias/
Downloaded packages cache.
.TP
.I /etc/bash_completion.d/urpm
Bash completion script.
.SH EXAMPLES
.TP
Install a package:
.B urpm i firefox
.TP
Search for packages:
.B urpm q video player
.TP
Update all packages:
.B urpm u
.TP
Remove a package without asking for confirmation :
.B urpm e \-y gimp
.TP
Show why a package is installed:
.B urpm why libpng
.TP
Update media metadata:
.B urpm m u
.SH SEE ALSO
.BR urpmd (8),
.BR rpm (8),
.SH BUGS
Report bugs at https://github.com/pvi-github/urpm-ng/issues
.SH AUTHORS
Pascal Vilarem (Maât) and contributors.
.SH COPYRIGHT
Copyright (C) 2024-2025 Pascal Vilarem (Maât).
Licensed under GPLv3+.
